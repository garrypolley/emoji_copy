<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Copy emojis easily - click to copy any emoji character to your clipboard">
    <meta name="theme-color" content="#3b82f6">
    <title>Emoji Copy - Easily Copy Emojis</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üòÄ</text></svg>">
    <link rel="stylesheet" href="output.css">
</head>
<body class="bg-gray-50">
    <div class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg">
            <div class="max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8">
                <h1 class="text-4xl font-bold">üòÄ Emoji Copy</h1>
                <p class="text-blue-100 mt-2 text-base">Click any emoji to copy it to your clipboard</p>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col">
            <!-- Sticky Search Bar -->
            <aside class="sticky top-0 bg-white z-50 shadow-sm">
                <div class="max-w-7xl mx-auto px-4 py-4 sm:px-6 lg:px-8">
                    <div class="flex items-center gap-4">
                        <button id="hamburger" class="flex md:hidden flex-col gap-1 cursor-pointer">
                            <span class="w-6 h-0.5 bg-blue-500 rounded transition-all"></span>
                            <span class="w-6 h-0.5 bg-blue-500 rounded transition-all"></span>
                            <span class="w-6 h-0.5 bg-blue-500 rounded transition-all"></span>
                        </button>
                        <input
                            type="text"
                            id="searchInput"
                            class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200"
                            placeholder="Search emojis by name or category..."
                            autocomplete="off"
                        />
                    </div>
                </div>
            </aside>

            <!-- Content Wrapper -->
            <div class="flex-1 flex">
                <!-- Sidebar Navigation -->
                <aside id="sidebar" class="hidden sm:hidden md:flex fixed md:static left-0 top-20 md:top-auto w-full md:w-48 max-h-[calc(100vh-5rem)] md:max-h-none bg-white flex-col gap-0.5 flex-shrink-0 p-4 md:p-0 overflow-y-auto md:overflow-visible overscroll-y-contain z-40">
                    <button class="sidebar-button active" data-category="all">All</button>
                    <div id="categoryTabs"></div>
                </aside>

                <!-- Emoji Content -->
                <section class="flex-1 max-w-7xl mx-auto px-4 py-2 md:py-8 sm:px-6 lg:px-8">
                    <div id="emojiGrid" class="emoji-grid">
                        <!-- Emojis will be inserted here -->
                    </div>

                    <div id="noResults" class="text-center text-gray-500 py-8 text-sm hidden">
                        <p>No emojis found. Try a different search.</p>
                    </div>
                </section>
            </div>

            <!-- Variant Modal -->
            <div id="variantModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
                <div class="bg-white rounded-lg shadow-lg max-w-md w-full p-6">
                    <h3 id="variantTitle" class="text-lg font-bold mb-4"></h3>
                    <div id="variantGrid" class="grid grid-cols-4 gap-3 mb-4">
                        <!-- Variants will be inserted here -->
                    </div>
                    <button id="closeVariantModal" class="w-full px-4 py-2 bg-gray-300 rounded hover:bg-gray-400 text-sm font-medium">
                        Close
                    </button>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-white border-t border-gray-200 mt-12">
            <div class="max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8">
                <p class="text-center text-gray-600 text-sm">
                    Made with ‚ù§Ô∏è | Works offline ¬∑ Supports 396+ emojis
                </p>
            </div>
        </footer>
    </div>

    <script>
        let emojiData = [];
        let currentCategory = 'all';

        // Load emoji data
        async function loadEmojis() {
            try {
                const response = await fetch('emojis.json');
                if (!response.ok) throw new Error('Failed to load emojis');
                const data = await response.json();
                emojiData = data.emojis;
                initializeCategories(data.categories);
                renderEmojis(emojiData);
            } catch (error) {
                console.error('Error loading emojis:', error);
                document.getElementById('noResults').textContent = 'Failed to load emojis. Please refresh the page.';
                document.getElementById('noResults').classList.remove('hidden');
            }
        }

        // Initialize category buttons from data
        function initializeCategories(categories) {
            const tabsContainer = document.getElementById('categoryTabs');
            tabsContainer.innerHTML = '';

            categories.forEach(category => {
                const button = document.createElement('button');
                button.className = 'sidebar-button';
                button.textContent = category;
                button.dataset.category = category;
                button.addEventListener('click', () => switchCategory(category, button));
                tabsContainer.appendChild(button);
            });

            // Add click handler to All button
            const allButton = document.querySelector('[data-category="all"]');
            if (allButton) {
                allButton.addEventListener('click', () => switchCategory('all', allButton));
            }
        }

        // Switch category
        function switchCategory(category, button) {
            currentCategory = category;

            // Update active button
            document.querySelectorAll('.sidebar-button').forEach(btn => {
                btn.classList.remove('active');
            });
            button.classList.add('active');

            // Clear search
            document.getElementById('searchInput').value = '';

            // Filter and render
            const filtered = category === 'all'
                ? emojiData
                : emojiData.filter(e => e.category === category);
            renderEmojis(filtered);

            // Close mobile menu
            closeSidebar();
        }

        // Render emojis
        function renderEmojis(emojis) {
            const grid = document.getElementById('emojiGrid');
            const noResults = document.getElementById('noResults');

            if (emojis.length === 0) {
                grid.innerHTML = '';
                noResults.classList.remove('hidden');
                return;
            }

            noResults.classList.add('hidden');
            grid.innerHTML = emojis.map(item => {
                const hasVariants = item.variants && item.variants.length > 0;
                const variantIndicator = hasVariants ? '<span style="font-size: 0.7rem; color: #999;">‚ãÆ</span>' : '';
                return `
                    <div class="emoji-item" data-emoji="${item.emoji}" data-has-variants="${hasVariants}" data-variants='${JSON.stringify(item.variants || [])}' title="${item.name}">
                        <div class="emoji-char">${item.emoji}</div>
                        <div class="emoji-name">${item.name}</div>
                        ${variantIndicator}
                    </div>
                `;
            }).join('');

            // Add click handlers
            document.querySelectorAll('.emoji-item').forEach(item => {
                const hasVariants = item.dataset.hasVariants === 'true';
                if (hasVariants) {
                    item.addEventListener('click', () => showVariants(item));
                } else {
                    item.addEventListener('click', () => copyEmoji(item));
                }
            });
        }

        // Show variants modal
        function showVariants(element) {
            const variants = JSON.parse(element.dataset.variants);
            const baseEmoji = element.dataset.emoji;
            const baseName = element.querySelector('.emoji-name').textContent;

            document.getElementById('variantTitle').textContent = `${baseName} - Select a variant`;

            const variantGrid = document.getElementById('variantGrid');
            variantGrid.innerHTML = `
                <div class="flex items-center justify-center p-3 rounded bg-gray-200 cursor-pointer hover:bg-gray-300" onclick="copyEmojiDirect('${baseEmoji}')">
                    <span style="font-size: 2rem;">${baseEmoji}</span>
                </div>
                ${variants.map((v, idx) => `
                    <div class="flex items-center justify-center p-3 rounded bg-gray-200 cursor-pointer hover:bg-gray-300" onclick="copyEmojiDirect('${v.emoji}')">
                        <span style="font-size: 2rem;">${v.emoji}</span>
                    </div>
                `).join('')}
            `;

            document.getElementById('variantModal').classList.remove('hidden');
        }

        // Copy emoji directly (for variants)
        function copyEmojiDirect(emoji) {
            navigator.clipboard.writeText(emoji).then(() => {
                showToast(`Copied to clipboard!`);
                document.getElementById('variantModal').classList.add('hidden');
            }).catch(() => {
                showToast('Failed to copy emoji', true);
            });
        }

        // Copy emoji to clipboard
        function copyEmoji(element) {
            const emoji = element.dataset.emoji;

            navigator.clipboard.writeText(emoji).then(() => {
                // Show visual feedback for longer
                const originalClass = element.className;
                element.classList.add('copied');

                setTimeout(() => {
                    element.className = originalClass;
                }, 600);

                // Show toast notification
                showToast(`Copied ${emoji} to clipboard!`);
            }).catch(err => {
                console.error('Failed to copy:', err);
                showToast('Failed to copy emoji', true);
            });
        }

        // Show toast notification
        function showToast(message, isError = false) {
            const toast = document.createElement('div');
            toast.className = isError ? 'fixed bottom-8 right-8 bg-red-500 text-white px-6 py-4 rounded shadow-lg z-50 animate-pulse'
                                        : 'fixed bottom-8 right-8 bg-green-500 text-white px-6 py-4 rounded shadow-lg z-50 animate-pulse';
            toast.textContent = message;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();

            if (!query) {
                const filtered = currentCategory === 'all'
                    ? emojiData
                    : emojiData.filter(em => em.category === currentCategory);
                renderEmojis(filtered);
                return;
            }

            const filtered = emojiData.filter(item =>
                item.searchable.includes(query)
            );
            renderEmojis(filtered);
        });

        // Hamburger menu functionality
        function initializeHamburger() {
            const hamburger = document.getElementById('hamburger');
            const sidebar = document.getElementById('sidebar');
            const allButton = sidebar.querySelector('button[data-category="all"]');

            hamburger.addEventListener('click', () => {
                hamburger.classList.toggle('active');
                sidebar.classList.toggle('hidden');
            });

            // Handle "All" button click
            if (allButton) {
                allButton.addEventListener('click', () => switchCategory('all', allButton));
            }

            // Close sidebar when clicking on a button (mobile)
            document.querySelectorAll('.sidebar-button').forEach(btn => {
                btn.addEventListener('click', () => {
                    closeSidebar();
                });
            });

            // Close sidebar when clicking outside
            document.addEventListener('click', (e) => {
                if (!sidebar.contains(e.target) && !hamburger.contains(e.target)) {
                    closeSidebar();
                }
            });
        }

        function closeSidebar() {
            const hamburger = document.getElementById('hamburger');
            const sidebar = document.getElementById('sidebar');
            hamburger.classList.remove('active');
            sidebar.classList.add('hidden');
        }

        // Close variant modal when close button is clicked
        document.getElementById('closeVariantModal').addEventListener('click', () => {
            document.getElementById('variantModal').classList.add('hidden');
        });

        // Close variant modal when clicking outside
        document.getElementById('variantModal').addEventListener('click', (e) => {
            if (e.target.id === 'variantModal') {
                document.getElementById('variantModal').classList.add('hidden');
            }
        });

        // Initialize on load
        document.addEventListener('DOMContentLoaded', () => {
            loadEmojis();
            initializeHamburger();
        });

        // Register service worker for offline support
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js').catch(() => {
                console.log('Service worker registration failed');
            });
        }
    </script>
</body>
</html>
